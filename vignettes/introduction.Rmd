---
title: "CorrDrugTumorMSI"
author: "Mridula Prasad"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The **CorrDrugTumorMSI** package contains different functions to analyze untargeted drug Mass Spectrometry Imaging data. The main objective of package is to provide methods to link observed drug distribution with unsupervised clusters identified. 


## Preprocessing of MSI data

folderpath <- 'path of folder contains MSI data'
mat <- PreprocessingMSIData('folderpath')
## Ion intensity matrix
IonInensityMatrix   <- mat[[1]][[1]] ;
## y-coordinate of MSI data
ycord               <- mat[[1]][[3]]; 
## x-coordinate of MSI data
xcord               <- mat[[1]][[2]]



## Create Spatial correlogram of spatial data 

## load synthetic spatial data

```{r}
library(CorrDrugTumorMSI)
data('spdata')

xycoord  <- as.matrix(expand.grid(1:80,1:10))
spcor <- CreateSpatialCorrelogram(xycoord,spdata[,1])

```

## Do clustering of input data matrix

```{r}
clusteredImg <- BisectKmeansClustering(spdata,cluster.size = 0.5)

```

## Create LISA map

```{r}
ionImg <- spdata[,1]
dim(ionImg) <- c(80,10)
LISAmap <- CreateLISAmap(ionImg,distthrs = 3)

```

## Quantitative analysis of LISA map 

```{r}
Qlisa <- ClusteredLISAimgQA(clusteredImg,LISAmap)

```


