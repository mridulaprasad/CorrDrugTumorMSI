---
title: "CorrDrugTumorMSI"
author: "Mridula Prasad"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The **CorrDrugTumorMSI** package contains different functions to analyze untargeted drug Mass Spectrometry Imaging data. The main objective of package is to provide methods to link observed drug distribution with unsupervised clusters identified. 


## Preprocessing of MSI data

folderpath <- 'path of folder contains MSI data'\
mat <- PreprocessingMSIData('folderpath')\
## Ion intensity matrix \
IonInensityMatrix   <- mat[[1]][[1]] \
## y-coordinate of MSI data \
ycord               <- mat[[1]][[3]]\  
## x-coordinate of MSI data \
xcord               <- mat[[1]][[2]] \



## Clustering of input data matrix

```{r}
library(CorrDrugTumorMSI)
data('spdata')
par(mar=c(1, 1, 1, 1))

clusteredImg <- BisectKmeansClustering(spdata,cluster.size = 0.5)
dim(clusteredImg) <- c(80,10)
image(clusteredImg,axes=FALSE)

```

## Creates a spatial correlogram of spatial data 

```{r}

xycoord  <- as.matrix(expand.grid(1:80,1:10))
spcor <- CreateSpatialCorrelogram(xycoord,spdata[,1])

```


## Creates a LISA map

```{r}
par(mar=c(1, 1, 1, 1))
ionImg <- spdata[,1]
dim(ionImg) <- c(80,10)
LISAmap <- CreateLISAmap(ionImg,distthrs = 3)

```

## Quantitative analysis of LISA map 

```{r}
par(mar=c(1, 1, 1, 1))
Qlisa <- ClusteredLISAimgQA(clusteredImg,LISAmap)

```


